# 個人資產視覺化系統 (PowerShell 版) - 使用說明

## 📋 系統簡介

這是一個整合 PowerShell 自動化腳本與 HTML 視覺化儀表板的個人資產管理系統。透過互動式的 PowerShell 介面輸入資產資料，並產生標準格式的 CSV 檔案，最後使用網頁儀表板進行視覺化分析。

### ✨ 主要特色
- **PowerShell 核心**：原生支援 Windows 環境，無需安裝 Python 或其他依賴。
- **模組化設計**：包含銀行資產、股票庫存、已實現損益等獨立模組。
- **互動式輸入**：透過選單引導，輕鬆輸入每日資產數據。
- **視覺化儀表板**：
    - 支援 **歷史日期篩選** 與回顧。
    - **動態圖表**：圓餅圖（資產分佈）與折線圖（資產趨勢）。
    - **詳細報表**：自動計算損益、佔比、總市值等關鍵指標。

---

## 🚀 快速開始

### 1. 環境需求
- **作業系統**：Windows 10 / 11
- **執行環境**：PowerShell 5.1 或更高版本
- **瀏覽器**：Chrome, Edge, Firefox 等現代瀏覽器

### 2. 檔案結構
```
資產視覺化/
├── README.md                  # 本說明文件
├── AssetManager.ps1           # 🚀 主程式入口 (啟動腳本)
├── common.ps1                 # 通用函式庫
├── account_list.txt           # 銀行帳戶設定檔
├── stock_list.txt             # 股票代號設定檔
├── index.html                 # 📊 視覺化儀表板
├── modules/                   # 功能模組
│   ├── BankAsset.ps1          # 銀行資產模組
│   ├── StockHolding.ps1       # 股票庫存模組
│   ├── RealizedPnL.ps1        # 已實現損益模組
│   └── DataMerger.ps1         # 資料合併工具
└── output/                    # 資料輸出目錄
    ├── bank_asset/            # 保存銀行資產 CSV
    ├── stock_holding/         # 保存股票庫存 CSV
    └── realized_pnl/          # 保存已實現損益 CSV
```

---

## 📝 使用步驟

### Step 1: 基礎設定

在使用前，請先編輯以下設定檔以符合您的個人情況：

#### 1. `account_list.txt` (銀行帳戶清單)
每行輸入一個帳戶名稱：
```text
台銀
富邦
國泰世華
```

#### 2. `stock_list.txt` (股票追蹤清單)
格式為 `市場,股票代號,股票名稱`：
```text
台股,2330,台積電
台股,2317,鴻海
ETF,00878,國泰永續高股息
美股,AAPL,蘋果
```

---

### Step 2: 輸入資產資料

1. 在資料夾中按右鍵，選擇 **「在終端機中開啟」** (Open in Terminal)。
2. 執行主程式：
   ```powershell
   .\AssetManager.ps1
   ```
3. 系統將顯示主選單，請依需求選擇功能：
   ```text
   ==================================
   💰 個人資產資料管理系統 (PowerShell)
   ==================================
   1. 🏦 銀行資產輸入
   2. 📈 股票庫存輸入
   3. 💸 已實現損益輸入
   4. 🔄 合併年度資料 (Merge CSV)
   0. 🚪 離開
   ==================================
   ```
4. **重要**：輸入完成後，建議執行選項 `4` **「合併年度資料」**，系統將詢問合併範圍：
    - `[1] 僅 YYYY 年度`：僅合併目前年份的資料。
    - `[2] 所有歷史交易紀錄`：合併過去所有資料（推薦）。

---

### Step 3: 啟動視覺化儀表板

1. 雙擊開啟 `index.html`。
2. 點擊畫面上的 **「🚀 一鍵載入全部 CSV」** 按鈕（或分別上傳）。
3. 選擇 `output` 資料夾中對應的合併檔案：
    - **銀行資產**：`output/ALL_HISTORY_merged_bank_assets.csv` (或 `YYYY_merged...`)
    - **股票庫存**：`output/ALL_HISTORY_merged_stock_holdings.csv` (或 `YYYY_merged...`)
    - **已實現損益**：`output/ALL_HISTORY_merged_realized_pnl.csv` (或 `YYYY_merged...`)

---

## 🎯 儀表板功能詳解

### 1. 個人資產 (銀行)
- **日期篩選**：可下拉選擇查看特定日期的資產狀態。
- **總資產趨勢**：折線圖顯示資產隨時間的增長變化（**刻度間距與顯示優化**）。
- **帳戶明細表**：列出各帳戶金額與資產佔比。

### 2. 股票庫存
- **損益分析**：自動計算未實現損益與報酬率，並以紅/綠色標示。
- **持股分佈**：依市值繪製圓餅圖。
- **歷史回顧**：透過日期選單可回溯過去的持股狀況。

### 3. 已實現損益
- **交易績效**：顯示總獲利/虧損金額。
- **交易明細**：詳細列出每一筆賣出的損益紀錄。

---

## 💡 常見問題 (FAQ)

### Q1: 執行腳本時出現「禁止執行指令碼」的錯誤？
**A**: 這是 PowerShell 的安全設定。請以管理員身分執行 PowerShell，並輸入以下指令開啟權限：
```powershell
Set-ExecutionPolicy RemoteSigned
```
選擇 `Y` 或 `A` 確認即可。

### Q2: 中文顯示亂碼怎麼辦？
**A**: 系統預設使用 **UTF-8 with BOM** 編碼，以確保 Excel 與網頁都能正常讀取。請勿使用記事本存成 ANSI 編碼。

### Q3: 為什麼圖表上有資料，但日期選單是空的？
**A**: 請確認您上傳的是 **合併後** 的 CSV 檔案（檔名通常包含 `merged`），而不是單日的原始檔案。單日檔案只有一天的資料，無法進行歷史篩選。

### Q4: 如何新增新的股票或帳戶？
**A**: 直接修改 `stock_list.txt` 或 `account_list.txt`，下次執行程式時就會自動載入新的清單。

---

## 🛠 更新日誌

- **2026-01-26**: 重構為 PowerShell 版本；新增儀表板日期篩選與明細表格功能；優化圖表刻度顯示。
